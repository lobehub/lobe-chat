---
title: åœ¨ LobeChat ä¸­é…ç½® Microsoft Entra ID èº«ä»½éªŒè¯æœåŠ¡
description: å­¦ä¹ å¦‚ä½•åœ¨ LobeChat ä¸­é…ç½® Microsoft Entra ID èº«ä»½éªŒè¯æœåŠ¡ï¼ŒåŒ…æ‹¬åˆ›å»ºåº”ç”¨ã€æ–°å¢ç”¨æˆ·å’Œé…ç½®ç¯å¢ƒå˜é‡ã€‚è¯¦ç»†æ­¥éª¤å’Œç›¸å…³èµ„æ–™ã€‚
tags:
  - Microsoft Entra ID
  - Microsoft Azure Portal
  - èº«ä»½éªŒè¯æœåŠ¡
  - åº”ç”¨æ³¨å†Œ
  - ç¯å¢ƒå˜é‡
  - ç”¨æˆ·ç®¡ç†
---

# é…ç½® Microsoft Entra ID èº«ä»½éªŒè¯æœåŠ¡

## Microsoft Entra ID é…ç½®æµç¨‹

<Steps>
  ### åˆ›å»º Microsoft Entra ID åº”ç”¨

åœ¨ä½ çš„ [Microsoft Azure Portal][microsoft-azure-portal] è¿›å…¥ Microsoft Entra ID -> App registrations -> New registration åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ã€‚

å¡«å†™ä½ æƒ³å‘ç»„ç»‡ç”¨æˆ·æ˜¾ç¤ºçš„åº”ç”¨åç§°ï¼Œé€‰æ‹©ä½ æœŸæœ›æ”¯æŒçš„è´¦æˆ·ç±»å‹ï¼Œå¦‚æœåªæ”¯æŒå†…éƒ¨ç”¨æˆ·è¯·é€‰æ‹© `Accounts in this organizational directory only (Default Directory only - Single tenant)`ã€‚

åœ¨ `Redirect URI (optional)` ä¸­ï¼Œåº”ç”¨ç±»å‹é€‰æ‹© `Web`ï¼ŒCallback URL, å¤„å¡«å†™ï¼š

```bash
https://your-domain/api/auth/callback/azure-ad
```

<Callout type={'info'}>
  - å¯ä»¥åœ¨ Register åå†å¡«å†™æˆ–ä¿®æ”¹ Redirect URIsï¼Œä½†æ˜¯åŠ¡å¿…ä¿è¯å¡«å†™çš„ URL ä¸éƒ¨ç½²çš„ URL ä¸€è‡´ã€‚ -
  your-domain è¯·å¡«å†™è‡ªå·±çš„åŸŸå
</Callout>

<Image
  alt="App Register"
  inStep
  src="https://github.com/lobehub/lobe-chat/assets/13883964/4f9d83bd-b3fc-4abc-bcf4-ccbad65c219d"
/>

ç‚¹å‡»ã€ŒRegisterã€

åˆ›å»ºæˆåŠŸåï¼Œç‚¹å‡»ç›¸åº”çš„åº”ç”¨ï¼Œè¿›å…¥åº”ç”¨è¯¦æƒ…é¡µï¼Œåˆ‡æ¢åˆ°ã€ŒOverviewã€æ ‡ç­¾é¡µï¼Œå°±å¯ä»¥çœ‹åˆ°ç›¸åº”çš„é…ç½®ä¿¡æ¯ã€‚

<Image
  alt="App Overview"
  inStep
  src="https://github.com/lobehub/lobe-chat/assets/13883964/48a0b702-05bd-4ce4-a007-a8ad00a36e5a"
/>

è¿›å…¥ã€ŒCertificates & secretsã€ï¼Œé€‰æ‹©ã€ŒClient secretsã€æ ‡ç­¾ï¼Œç‚¹å‡»ã€ŒNew client secretã€ï¼Œå¡«å†™æè¿°ï¼Œé€‰æ‹©è¿‡æœŸæ—¶é—´ï¼Œç‚¹å‡»ã€ŒAddã€ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å®¢æˆ·ç«¯å¯†é’¥ã€‚

<Image
  alt="Create App Client Secret"
  inStep
  src="https://github.com/lobehub/lobe-chat/assets/13883964/c9d66fa0-158c-4bd3-a1fa-969e638259d2"
/>

<Callout type={'important'}>è¯·åŠ¡å¿…ä¿å­˜å¥½ä½ çš„å®¢æˆ·ç«¯å¯†é’¥ï¼Œå› ä¸ºè¿™æ˜¯ä½ å”¯ä¸€çš„æœºä¼šæŸ¥çœ‹å®ƒã€‚</Callout>

### æ–°å¢ç”¨æˆ·

å›åˆ°ã€ŒMicrosoft Entra IDã€ç•Œé¢ï¼Œè¿›å…¥ã€ŒUsersã€ï¼Œç‚¹å‡»ã€ŒNew userã€ï¼Œå¡«å†™ç”¨æˆ·ä¿¡æ¯ï¼Œç‚¹å‡»ã€ŒCreateã€ï¼Œåˆ›å»ºç”¨æˆ·ä»¥ä½¿ç”¨ LobeChatã€‚

### é…ç½®ç¯å¢ƒå˜é‡

åœ¨éƒ¨ç½² LobeChat æ—¶ï¼Œä½ éœ€è¦é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| ç¯å¢ƒå˜é‡ | ç±»å‹ | æè¿° |
| --- | --- | --- |
| `NEXT_AUTH_SECRET` | å¿…é€‰ | ç”¨äºåŠ å¯† Auth.js ä¼šè¯ä»¤ç‰Œçš„å¯†é’¥ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆç§˜é’¥ï¼š `openssl rand -base64 32` |
| `NEXT_AUTH_SSO_PROVIDERS` | å¿…é€‰ | é€‰æ‹© LoboChat çš„å•ç‚¹ç™»å½•æä¾›å•†ã€‚ä½¿ç”¨ Microsoft Entra ID è¯·å¡«å†™ `azure-ad`ã€‚ |
| `AZURE_AD_CLIENT_ID` | å¿…é€‰ | Microsoft Entra ID åº”ç”¨ç¨‹åºçš„ Client ID |
| `AZURE_AD_CLIENT_SECRET` | å¿…é€‰ | Microsoft Entra ID åº”ç”¨ç¨‹åºçš„ Client Secret |
| `AZURE_AD_TENANT_ID` | å¿…é€‰ | Microsoft Entra ID åº”ç”¨ç¨‹åºçš„ Tenant ID |
| `NEXTAUTH_URL` | å¯é€‰ | è¯¥ URL ç”¨äºæŒ‡å®š Auth.js åœ¨æ‰§è¡Œ OAuth éªŒè¯æ—¶çš„å›è°ƒåœ°å€ï¼Œå½“é»˜è®¤ç”Ÿæˆçš„é‡å®šå‘åœ°å€å‘ç”Ÿä¸æ­£ç¡®æ—¶æ‰éœ€è¦è®¾ç½®ã€‚`https://example.com/api/auth` |

  <Callout type={'tip'}>
    å‰å¾€ [ğŸ“˜ ç¯å¢ƒå˜é‡](/zh/docs/self-hosting/environment-variable#microsoft-entra-id) å¯æŸ¥é˜…ç›¸å…³å˜é‡è¯¦æƒ…ã€‚

</Callout>
</Steps>

<Callout type={'info'}>
  éƒ¨ç½²æˆåŠŸåï¼Œç”¨æˆ·å°†å¯ä»¥ä½¿ç”¨ Microsoft Entra ID ä¸­é…ç½®çš„ç”¨æˆ·é€šè¿‡èº«ä»½è®¤è¯å¹¶ä½¿ç”¨ LobeChatã€‚
</Callout>

## è¿›é˜¶é…ç½®

è¯·åœ¨ [Microsoft Entra ID å­¦ä¹ ä¸­å¿ƒ][microsoft-learn-entra]ï¼Œåšè¿›ä¸€æ­¥æ¢ç´¢ã€‚

## ç›¸å…³èµ„æ–™

- [å¿«é€Ÿæ³¨å†Œåº”ç”¨æŒ‡å¯¼][microsoft-entra-register-app]

[microsoft-azure-portal]: https://portal.azure.com/
[microsoft-entra-register-app]: https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app
[microsoft-learn-entra]: https://learn.microsoft.com/en-us/entra/identity/
