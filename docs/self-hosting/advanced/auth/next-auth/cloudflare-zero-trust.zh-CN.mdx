---
title: åœ¨ LobeChat ä¸­é…ç½® Cloudflare Zero Trust èº«ä»½éªŒè¯æœåŠ¡
description: >-
  å­¦ä¹ å¦‚ä½•åœ¨ LobeChat ä¸­é…ç½® Cloudflare Zero Trust èº«ä»½éªŒè¯æœåŠ¡ï¼ŒåŒ…æ‹¬åˆ›å»ºæä¾›ç¨‹åºã€é…ç½®ç¯å¢ƒå˜é‡å’Œéƒ¨ç½²
  LobeChatã€‚è¯¦ç»†æ­¥éª¤å’Œå¿…è¦ç¯å¢ƒå˜é‡è®¾ç½®ã€‚
tags:
  - Cloudflare Zero Trust
  - èº«ä»½éªŒè¯
  - å•ç‚¹ç™»å½•
  - ç¯å¢ƒå˜é‡
  - LobeChat
---

# é…ç½® Cloudflare Zero Trust èº«ä»½éªŒè¯æœåŠ¡

## Cloudflare Zero Trust é…ç½®æµç¨‹

<Steps>
### åœ¨ Cloudflare Zero Trust ä¸­åˆ›å»ºåº”ç”¨

æˆ‘ä»¬ç°åœ¨é»˜è®¤æ‚¨å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨ Cloudflare Zero Trust å¹³å°ä¸”å‡è®¾æ‚¨çš„ LobeChat å®ä¾‹éƒ¨ç½²åœ¨ `https://chat.example.com` ä¸­ã€‚

é¦–å…ˆæˆ‘ä»¬éœ€è¦è®¿é—® `https://one.dash.cloudflare.com/` å¹¶å‰å¾€ `Access - Applications` ä¸­ã€‚

![image](https://github.com/user-attachments/assets/4d671a7c-5d94-4c4b-b4fd-71a5a0e9d227)

ç°åœ¨ï¼Œåœ¨æ‰€åœ¨é¡µé¢ç‚¹å‡» `Add an application` å¹¶é€‰æ‹© `SaaS`ã€‚

![image](https://github.com/user-attachments/assets/3da4c8c4-88c6-40a9-8005-6a0a44aa3b1f)

åœ¨ `Application` æ–‡æœ¬æ¡†å†…å¡«å…¥åº”ç”¨åç§°ï¼Œå¦‚ï¼š`LobeChat SSO`ï¼Œç„¶åç‚¹å‡» `Select OIDC` åç‚¹å‡» `Add applicaiton`

![image](https://github.com/user-attachments/assets/16cd9aef-c87b-48a4-95c0-b666082e7515)

è‡³æ­¤æ‚¨å·²æˆåŠŸåœ¨ Clouflare Zero Trust ä¸­åˆ›å»ºäº†ä¸€ä¸ªåä¸º `LobeChat SSO` çš„ SaaS åº”ç”¨ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨ `Redirect URLs` ä¸­å¡«å…¥ `https://chat.example.com/api/auth/callback/cloudflare-zero-trust`ï¼ˆæ³¨æ„æ­¤å¤„çš„ `chat.example.com` éœ€è¦æ›¿æ¢ä¸ºæ‚¨çš„å®ä¾‹åœ°å€ï¼‰
![image](https://github.com/user-attachments/assets/433fdce4-0af5-417f-b80d-163c2d4f02f6)

æœ€åæˆ‘ä»¬å°†é¡µé¢å¾€ä¸‹æ»šåŠ¨ï¼Œæ‚¨å°†éœ€è¦è®°å½•ä»¥ä¸‹ä¸‰ä¸ªå€¼ `Client secret`, `Client ID` åŠ `Issuer` ä»¥å¤‡åç»­éƒ¨ç½² LobeChat ç¯å¢ƒå˜é‡ä½¿ç”¨ã€‚

![image](https://github.com/user-attachments/assets/2dd3cde5-fa0d-4f52-b82b-28d9e89379a0)

### é…ç½®ç¯å¢ƒå˜é‡

åœ¨éƒ¨ç½² LobeChat æ—¶ï¼Œä½ éœ€è¦é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| ç¯å¢ƒå˜é‡ | ç±»å‹ | æè¿° |
| --- | --- | --- |
| `NEXT_AUTH_SECRET` | å¿…é€‰ | ç”¨äºåŠ å¯† Auth.js ä¼šè¯ä»¤ç‰Œçš„å¯†é’¥ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆç§˜é’¥ï¼š `openssl rand -base64 32` |
| `NEXT_AUTH_SSO_PROVIDERS` | å¿…é€‰ | é€‰æ‹© LoboChat çš„å•ç‚¹ç™»å½•æä¾›å•†ã€‚ä½¿ç”¨ Cloudflare Zero Trust è¯·å¡«å†™ `cloudflare-zero-trust`ã€‚ |
| `AUTH_CLOUDFLARE_ZERO_TRUST_ID` | å¿…é€‰ | åœ¨ Cloudflare Zero Trust ç”Ÿæˆçš„ `Client ID`ï¼Œç¤ºä¾‹å€¼æ˜¯ `lobe-chat` |
| `AUTH_CLOUDFLARE_ZERO_TRUST_SECRET` | å¿…é€‰ | åœ¨ Cloudflare Zero Trust ç”Ÿæˆçš„ `Client secret`ï¼Œç¤ºä¾‹å€¼æ˜¯ `insecure_secret` |
| `AUTH_CLOUDFLARE_ZERO_TRUST_ISSUER` | å¿…é€‰ | åœ¨ Cloudflare Zero Trust ç”Ÿæˆçš„ `Issuer`ï¼Œä¾‹å¦‚ `https://example.cloudflareaccess.com/cdn-cgi/access/sso/oidc/7db0f` |
| `NEXTAUTH_URL` | å¿…é€‰ | è¯¥ URL ç”¨äºæŒ‡å®š Auth.js åœ¨æ‰§è¡Œ OAuth éªŒè¯æ—¶çš„å›è°ƒåœ°å€ï¼Œå½“é»˜è®¤ç”Ÿæˆçš„é‡å®šå‘åœ°å€å‘ç”Ÿä¸æ­£ç¡®æ—¶æ‰éœ€è¦è®¾ç½®ã€‚`https://chat.example.com/api/auth` |

  <Callout type={'tip'}>
    å‰å¾€ [ğŸ“˜ ç¯å¢ƒå˜é‡](/zh/docs/self-hosting/environment-variable#Cloudflare%20Zero%20Trust) å¯æŸ¥é˜…ç›¸å…³å˜é‡è¯¦æƒ…ã€‚

</Callout>
</Steps>

<Callout type={'info'}>
  éƒ¨ç½²æˆåŠŸåï¼Œç”¨æˆ·å°†å¯ä»¥ä½¿ç”¨ Cloudflare Zero Trust ä¸­é…ç½®çš„ç”¨æˆ·é€šè¿‡èº«ä»½è®¤è¯å¹¶ä½¿ç”¨ LobeChatã€‚
</Callout>
