@chat @session
Feature: 会话管理
  测试聊天会话的创建、编辑、删除等管理功能

  Background:
    Given 应用正在运行

  # ============================================
  # 创建会话
  # ============================================

  @CHAT-SESSION-001 @P1
  Scenario: 创建新的助手会话
    Given 我访问 "/chat"
    When 我点击新建会话按钮
    Then 应该创建一个新会话
    And 我应该看到新会话的聊天界面
    And URL 应该包含新的会话 ID

  @CHAT-SESSION-002 @P1
  Scenario: 创建 Agent 团队
    Given 我访问 "/chat"
    When 我点击新建 Agent 团队按钮
    Then 应该打开创建团队的对话框
    And 我应该看到团队成员选择界面

  # ============================================
  # 会话切换
  # ============================================

  @CHAT-SESSION-003 @P1
  Scenario: 在会话之间切换
    Given 我访问 "/chat"
    And 存在多个会话
    When 我点击另一个会话
    Then 应该切换到该会话
    And 应该显示该会话的聊天记录
    And URL 应该更新为新的会话 ID

  # ============================================
  # 会话编辑
  # ============================================

  @CHAT-SESSION-004 @P1
  Scenario: 重命名会话
    Given 我访问 "/chat"
    And 存在一个会话
    When 我右键点击会话项
    And 我选择重命名选项
    And 我输入新的会话名称
    And 我确认重命名
    Then 会话名称应该更新

  @CHAT-SESSION-005 @P1
  Scenario: 复制会话
    Given 我访问 "/chat"
    And 存在一个会话
    When 我右键点击会话项
    And 我选择复制选项
    Then 应该创建一个会话副本
    And 新会话名称应该包含"副本"

  # ============================================
  # 会话删除
  # ============================================

  @CHAT-SESSION-006 @P1
  Scenario: 删除会话
    Given 我访问 "/chat"
    And 存在一个会话
    When 我右键点击会话项
    And 我选择删除选项
    And 我确认删除
    Then 该会话应该被删除
    And 会话列表中不应该再显示该会话

  # ============================================
  # 会话置顶
  # ============================================

  @CHAT-SESSION-007 @P1
  Scenario: 置顶会话
    Given 我访问 "/chat"
    And 存在一个会话
    When 我右键点击会话项
    And 我选择置顶选项
    Then 该会话应该被置顶
    And 会话应该显示在列表顶部

  @CHAT-SESSION-008 @P1
  Scenario: 取消置顶会话
    Given 我访问 "/chat"
    And 存在一个已置顶的会话
    When 我右键点击该会话项
    And 我选择取消置顶选项
    Then 该会话应该取消置顶
    And 会话应该回到正常位置

  # ============================================
  # 会话分组
  # ============================================

  @CHAT-SESSION-009 @P1
  Scenario: 创建会话分组
    Given 我访问 "/chat"
    When 我点击创建分组按钮
    And 我输入分组名称
    And 我确认创建
    Then 应该创建新的分组
    And 我应该在会话列表中看到新分组

  @CHAT-SESSION-010 @P1
  Scenario: 将会话添加到分组
    Given 我访问 "/chat"
    And 存在一个会话和一个分组
    When 我拖拽会话到分组中
    Then 会话应该被添加到该分组
    And 会话应该显示在分组下

  @CHAT-SESSION-011 @P1
  Scenario: 删除分组
    Given 我访问 "/chat"
    And 存在一个分组
    When 我右键点击分组
    And 我选择删除分组选项
    And 我确认删除
    Then 该分组应该被删除
    And 分组中的会话应该移到默认列表

  # ============================================
  # 会话搜索
  # ============================================

  @CHAT-SESSION-012 @P1
  Scenario: 搜索会话
    Given 我访问 "/chat"
    And 存在多个会话
    When 我在搜索框中输入关键词
    Then 应该显示匹配的会话
    And 不匹配的会话应该被隐藏

  @CHAT-SESSION-013 @P1
  Scenario: 清空搜索
    Given 我访问 "/chat"
    And 我已经搜索了会话
    When 我清空搜索框
    Then 应该显示所有会话

  # ============================================
  # 收件箱
  # ============================================

  @CHAT-SESSION-014 @P1
  Scenario: 访问收件箱
    Given 我访问 "/chat"
    When 我点击收件箱入口
    Then 应该切换到收件箱会话
    And 我应该看到收件箱的欢迎信息
